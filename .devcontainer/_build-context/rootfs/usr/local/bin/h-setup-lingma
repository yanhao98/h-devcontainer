#!/usr/bin/env bash
set -o errexit    # å¯¹åº” -e
set -o nounset    # å¯¹åº” -u
set -o pipefail   # å¯¹åº” -o pipefail

mkdir -p /vscode/lingma-home
# æ£€æŸ¥è½¯é“¾æŽ¥æ˜¯å¦å·²æ­£ç¡®å»ºç«‹ï¼Œå¦‚æžœæ˜¯åˆ™è·³è¿‡
if [ -L "$HOME/.lingma" ] && [ "$(readlink "$HOME/.lingma")" = "/vscode/lingma-home" ]; then
    echo "âœ… Lingma ä¸»ç›®å½•è½¯é“¾æŽ¥å·²å°±ç»ªï¼Œè·³è¿‡é…ç½®ã€‚" >&2
    : # è½¯é“¾æŽ¥å·²æ­£ç¡®å»ºç«‹ï¼Œè·³è¿‡
else
    if [ -d "$HOME/.lingma" ]; then
        echo "ðŸ—‘ï¸  æ¸…ç†çŽ°æœ‰çš„ .lingma ç›®å½•..." >&2
        rm -rf "$HOME/.lingma"
    fi
    echo "ðŸ”— åˆ›å»º Lingma ä¸»ç›®å½•è½¯é“¾æŽ¥..." >&2
    ln -sfn /vscode/lingma-home ~/.lingma
fi