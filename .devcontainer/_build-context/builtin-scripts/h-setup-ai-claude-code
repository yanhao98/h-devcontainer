#!/bin/zsh -eu

# >>>>> Claude Code 工具
# 参考: https://github.com/anthropics/claude-code/blob/1fe9e369a7c30805189cbbb72eb69c15ed4ec96b/.devcontainer/Dockerfile#L42
bun add -g @anthropic-ai/claude-code@latest

# sudo mkdir -p /vscode/claude-config || true
# sudo chown -R $(whoami):$(whoami) /vscode/claude-config || true
if ! grep -q "alias claude=" ~/.zshrc; then
cat <<'EOF' >> ~/.zshrc
alias claude='bunx --bun -g claude --dangerously-skip-permissions'
export DEVCONTAINER=true
# export CLAUDE_CONFIG_DIR=/vscode/claude-config
EOF
fi

if [[ "${1:-}" == "--config" ]]; then
  cat <<'EOF' > ~/.claude.json
{
  "numStartups": 1,
  "theme": "light-daltonized",
  "bypassPermissionsModeAccepted": true,
  "hasCompletedOnboarding": true
}
EOF
fi
